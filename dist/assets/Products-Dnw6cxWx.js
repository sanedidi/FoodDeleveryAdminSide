import{r as a,j as e,B as s,C as O,L as N,y as v,z as R,J as T,K as F,T as z}from"./index-DSiRzrbg.js";import{A,H,I as U,C as W,a as $,R as q,c as J,_ as L}from"./MainProd-DW19dvKP.js";import{s as S,D as K,E as G,S as Q}from"./Categories.module-B_Ij1KM_.js";import{D as V,h as X}from"./html2canvas.esm-D6hi9gc2.js";import{r as D}from"./index-C0teDyxI.js";import{M as Y,U as Z,C as ee}from"./CustomTable-Bb3MW7ZR.js";import"./chunk-DEQZ7DVA-L72d_YGu.js";import"./clsx-B-dksMZM.js";const te=()=>{const[n,j]=a.useState([]),[C,y]=a.useState(!1),[m,_]=a.useState(!1),[I,P]=a.useState(null),[c,x]=a.useState(1),[l,d]=a.useState(10),[h,i]=a.useState(10),[u,p]=a.useState(!1),w=()=>y(!1),M=()=>_(!0),k=()=>_(!1),b=async(t=1,o=10,r="")=>{p(!0);try{const f=await D.get("/products",{params:{page:r.length?null:t,limit:r.length?null:o,search:r}}),E=f.data.Data.products;E.length===0&&console.log("Ничего не найдено по вашему запросу"),j(E),i(Math.ceil(f.data.Data.count/o))}catch(f){console.error("Error fetching products:",f)}finally{p(!1)}};return a.useEffect(()=>{b(c,l)},[c,l]),{columns:[{title:"No",key:"number",dataIndex:"number",width:0},{title:"Продукт",dataIndex:"name",key:"name",width:120},{title:"Категория",dataIndex:"category_id",key:"category_id",width:120,render:t=>{const o=n.find(r=>r.category_id===t);return o?o.CategoryData.name:""}},{title:"Цена Продажи",dataIndex:"sale_price",key:"sale_price",width:120},{title:"Дата создания",dataIndex:"created_at",key:"created_at",width:120},{title:e.jsx(s,{style:{margin:"0 auto",width:"max-content"},children:e.jsx(O,{})}),key:"operations",width:20,render:t=>e.jsx(s,{children:e.jsx(Y,{MenuBtn:e.jsx("div",{style:{boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)",padding:"0px",background:"transparent"},children:e.jsx(A,{style:{fontWeight:"900",fontSize:"30px",border:"1px solid rgba(231, 231, 231, 1)",borderRadius:"5px",background:"#fff"},color:"#0E73FC"})}),ListMenu:e.jsx(s,{className:S.categories__menu,children:e.jsxs(s,{onClick:()=>{M(),P(t.id)},className:S.categories__menu,children:["Удалить",e.jsx(K,{color:"#0E73FC"})]})}),ListMenu1:e.jsxs(N,{to:`/admin/categories/products/edit/${t.id}`,className:S.categories__menu,children:["Изменить",e.jsx(G,{color:"#0E73FC"})]})})})}],data:n.map((t,o)=>({key:t.id||o,number:(c-1)*l+o+1,...t})),paginationData:{current:c,pageSize:l,totalPages:h},isLoading:u,isOpenModal1:C,onCloseModal1:w,isOpenModal2:m,onCloseModal2:k,setSelectedProductId:P,selectedProductId:I,currentPage:c,setCurrentPage:x,pageSize:l,setPageSize:d,getProducts:b,setIsOpenModal2:_}},se="_products__wrapper_loo2l_1",ae="_products__pagination_loo2l_9",oe="_products__edit_loo2l_12",re="_orders__tabs_loo2l_17",ne="_orders__tabs_wrapper_loo2l_20",ce="_orders__tabs_table_loo2l_27",le="_orders__tabs_pag_loo2l_30",g={products__wrapper:se,products__pagination:ae,products__edit:oe,orders__tabs:re,orders__tabs_wrapper:ne,orders__tabs_table:ce,orders__tabs_pag:le},he=()=>{const n=a.useRef(null),{data:j,columns:C,isOpenModal2:y,setIsOpenModal2:m,selectedProductId:_,paginationData:I,isLoading:P,setIsLoading:c,getProducts:x,onCloseModal2:l}=te(),[d,h]=v(),i=+d.get("page")||1,u=+d.get("limit")||10,p=d.get("search")||"",{current:w,totalPages:M}=I,k=async()=>{try{await D.delete(`https://food-delivery-api-n6as.onrender.com/v1/product/${_}`),L.success("Продукт удален успешно"),m(!1),x(i,u,p)}catch{L.error("Что-то пошло не так, повторите попытку!")}},b=t=>{h({...d,page:t.selected+1})};a.useEffect(()=>{x(i,u,p)},[i,u,p]);const B=()=>{n.current&&X(n.current).then(t=>{t.toBlob(o=>{const r=document.createElement("a");r.href=URL.createObjectURL(o),r.download="products.png",r.click()},"image/png")})};return e.jsxs(e.Fragment,{children:[e.jsx(H,{title:"Продукты ",headerBtn2:e.jsxs(N,{to:"/admin/categories/products/add",className:"header_btn1",children:[e.jsx(R,{})," Добавить"]})}),e.jsx(U,{}),e.jsx(Z,{firstItem:e.jsx(W,{InputPlaceHolder:"Поиск...",onChange:t=>{h({search:t.target.value})},InputIcon:e.jsx(Q,{color:"blue"})}),thirdItem:e.jsx($,{BgColor:"white",type:"button",Onclick:B,BtnBorder:"1px solid #E5E9EB",BtnContent:e.jsxs(s,{style:{display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(V,{color:"blue"}),e.jsx("p",{style:{color:"#000",fontWeight:"500"},children:"Скачать"})]})})}),e.jsxs(s,{className:g.orders__tabs,children:[e.jsx(s,{className:g.orders__tabs_wrapper,children:e.jsx(s,{ref:n,className:g.orders__tabs_table,children:e.jsx(ee,{columns:C,data:j})})}),e.jsx(s,{className:g.orders__tabs_pag,children:e.jsx(q,{previousLabel:e.jsx(T,{}),nextLabel:e.jsx(F,{}),breakLabel:"...",breakClassName:"break-me",pageCount:M,current:w,marginPagesDisplayed:2,pageRangeDisplayed:5,onPageChange:b,containerClassName:"pagination",subContainerClassName:"pages pagination",activeClassName:"activePagination",className:g.products_pag,initialPage:i-1})})]}),e.jsx(e.Fragment,{children:e.jsx(J,{isOpenModal:y,onCloseModal:()=>m(!1),modalTitle:e.jsx(s,{margin:"0 auto",textAlign:"center",width:"max-content",children:e.jsx(z,{})}),modalContent:e.jsx(s,{fontWeight:"600",fontSize:"20px",textAlign:"center",children:"Вы уверены, что хотите удалить этот товар?"}),secondaryBtnText:e.jsx(s,{children:"Нет"}),ModalBtnBgColor:"blue",primaryBtnText:"Да",onPrimaryBtnClick:()=>{k()}})})]})};export{he as Products,he as default};
